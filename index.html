<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GLITCH MONEY ‚Äî Pink Cute Edition</title>
<style>
:root{
  --bg:#fff0f7;
  --card:#ffe3f2;
  --accent:#ff6bd6;
  --muted:#b46ba1;
  --danger:#ff3366;
  font-family: Inter, "Segoe UI", Roboto, system-ui, -apple-system, sans-serif;
}
*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  background:linear-gradient(180deg,#ffb6f0,#ffd6f9,#fff0f7);
  color:#4a0044;
}
.container{max-width:980px;margin:18px auto;padding:14px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.title{font-family:monospace;font-size:20px;letter-spacing:1px;color:#ff2fb0;text-shadow:0 0 6px rgba(255,0,170,0.5)}
.sub{color:var(--muted);font-size:12px}
.card{background:rgba(255,255,255,0.7);padding:12px;border-radius:10px;margin-top:12px;
      box-shadow:0 8px 20px rgba(255,0,200,0.2);border:1px solid rgba(255,0,180,0.2)}
.row{display:flex;gap:8px;align-items:center}
.row.col{flex-direction:column;align-items:stretch}
input,select,button{padding:9px;border-radius:8px;border:1px solid rgba(255,0,180,0.3);
  background:transparent;color:inherit;font-size:14px}
button{cursor:pointer;background:#ffb3e6;border:1px solid #ff7ac6;color:#4a0044}
.table{width:100%;border-collapse:collapse;margin-top:12px}
.table th{font-size:13px;text-align:left;padding:8px;color:var(--muted);border-bottom:1px dashed rgba(255,0,180,0.3)}
.table td{padding:10px;border-bottom:1px dashed rgba(255,0,180,0.15);font-size:14px}
.badge-income{color:#00b894}
.badge-expense{color:var(--danger)}
.totals{font-weight:700;background:rgba(255,255,255,0.4);padding:10px}
.small{font-size:12px;color:var(--muted)}
.controls{display:flex;gap:8px;flex-wrap:wrap}
.toast{position:fixed;right:12px;bottom:12px;background:rgba(255,192,230,0.9);
  border:1px dashed #ff6bd6;padding:8px 12px;color:#4a0044;font-family:monospace;border-radius:6px;z-index:9999}
@keyframes flicker{0%{opacity:1}50%{opacity:0.86;transform:skewX(-0.4deg)}100%{opacity:1}}
.title{animation:flicker 3s infinite}
footer{margin-top:12px;color:var(--muted);font-size:12px}
.mobile-full{width:100%}
@media(min-width:640px){.input-inline{flex:1}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <div class="title">GLITCH MONEYüéÄ</div>
      <div class="sub">Keylla Chan ‚Äî Annual Financial Report</div>
    </div>
    <div class="small">bzzzt ‚Äî localStorage persistence</div>
  </div>

  <div class="card" id="formCard">
    <div class="row">
      <select id="kind" class="mobile-full" style="width:110px">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>
      <input id="amount" type="number" step="0.01" placeholder="Amount" class="input-inline" />
      <input id="date" type="date" />
      <input id="desc" type="text" placeholder="Description (optional)" class="input-inline" />
      <button id="addBtn">Add</button>
    </div>
    <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;">
      <div class="controls">
        <button id="exportBtn">Export CSV</button>
        <button id="importBtn">Import CSV</button>
        <button id="clearBtn">Clear All</button>
      </div>
      <div class="small">
        <label><input type="checkbox" id="npcToggle"> NPC Mode</label>
      </div>
    </div>
  </div>

  <div class="card" id="tableCard">
    <table class="table" id="entriesTable">
      <thead><tr><th>Date</th><th>Type</th><th>Description</th><th>Amount</th><th>Action</th></tr></thead>
      <tbody></tbody>
      <tfoot><tr class="totals"><td colspan="3">Totals</td><td id="totalAmount">0.00</td><td></td></tr></tfoot>
    </table>
  </div>

  <footer>Data stored locally (localStorage). Works offline on iPhone Safari. bzzzt üéÄ</footer>
</div>

<input type="file" id="fileInput" accept=".csv" style="display:none" />

<script>
const SKEY="glitch_money_entries_v1";let NPC_MODE=false;
function toast(msg,ttl=2800){const t=document.createElement("div");t.className="toast";t.textContent=msg;document.body.appendChild(t);setTimeout(()=>t.remove(),ttl+Math.random()*1500)}
function nowISO(d=new Date()){return d.toISOString().slice(0,10)}
function fmtCurrency(v){return Number(v||0).toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})}
function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2,7)}
function loadEntries(){try{const raw=localStorage.getItem(SKEY);if(!raw)return[];return JSON.parse(raw)}catch(e){return[]}}
function saveEntries(l){localStorage.setItem(SKEY,JSON.stringify(l));if(NPC_MODE)toast("[NPC] autosave ‚Äî token overflow")}
const tbody=document.querySelector("#entriesTable tbody"),totalEl=document.getElementById("totalAmount"),
addBtn=document.getElementById("addBtn"),exportBtn=document.getElementById("exportBtn"),
importBtn=document.getElementById("importBtn"),clearBtn=document.getElementById("clearBtn"),
fileInput=document.getElementById("fileInput"),npcToggle=document.getElementById("npcToggle");
function render(){const list=loadEntries();tbody.innerHTML="";let total=0;
list.sort((a,b)=>(b.date+b.id)>(a.date+a.id)?1:-1);
list.forEach(it=>{const tr=document.createElement("tr"),kindBadge=it.kind==="income"?`<span class="badge-income">Income</span>`:`<span class="badge-expense">Expense</span>`;
tr.innerHTML=`<td>${it.date}</td><td>${kindBadge}</td><td>${(it.description||"").slice(0,160)}</td>
<td style="text-align:right">${fmtCurrency(it.amount)}</td>
<td><button data-id="${it.id}" class="editBtn">‚úèÔ∏è</button><button data-id="${it.id}" class="delBtn">üóëÔ∏è</button></td>`;
tbody.appendChild(tr);total+=(it.kind==="income"?1:-1)*Number(it.amount)});
totalEl.textContent=fmtCurrency(total);attachHandlers();if(NPC_MODE)toast("[NPC] render loop stuck")}
function attachHandlers(){document.querySelectorAll(".delBtn").forEach(b=>{b.onclick=()=>{const id=b.dataset.id;if(!confirm("Yakin hapus?"))return;
let l=loadEntries().filter(x=>x.id!==id);saveEntries(l);render();toast("deleted ‚úî")}});document.querySelectorAll(".editBtn").forEach(b=>{b.onclick=()=>{const id=b.dataset.id;const list=loadEntries();const it=list.find(x=>x.id===id);if(!it)return toast("item not found");
const desc=prompt("New description:",it.description||"");if(desc===null)return;const amt=prompt("New amount:",it.amount);if(amt===null)return;
it.description=desc||it.description;it.amount=Number(amt)||it.amount;saveEntries(list);render();toast("edited ‚úî")}})}
addBtn.onclick=()=>{const kind=document.getElementById("kind").value,amount=Number(document.getElementById("amount").value),
date=document.getElementById("date").value||nowISO(),desc=document.getElementById("desc").value;
if(!amount||isNaN(amount)){toast("Masukin nominal dulu");return}const list=loadEntries();
list.push({id:uid(),kind,amount:Number(amount),description:desc,date});saveEntries(list);
document.getElementById("amount").value="";document.getElementById("desc").value="";render();toast("added ‚úî bzzzt")}
exportBtn.onclick=()=>{const list=loadEntries();if(!list.length){toast("No data");return}
const header=["id","kind","amount","description","date"],rows=[header,...list.map(r=>[r.id,r.kind,r.amount,r.description||"",r.date])],
csv=rows.map(r=>r.map(c=>`"${String(c).replace(/"/g,'""')}"`).join(",")).join("\n"),
blob=new Blob([csv],{type:"text/csv"}),url=URL.createObjectURL(blob),a=document.createElement("a");
a.href=url;a.download="glitch-money.csv";a.style.display="none";document.body.appendChild(a);
a.click();setTimeout(()=>{document.body.removeChild(a);URL.revokeObjectURL(url)},1000);
toast("CSV exported ‚úî ‚Äî file downloaded")}
importBtn.onclick=()=>fileInput.click();fileInput.onchange=async e=>{const f=e.target.files[0];if(!f)return;
const txt=await f.text(),lines=txt.split(/\r?\n/).filter(Boolean);if(!lines.length)return toast("file kosong");
const parsed=lines.slice(1).map(l=>{const cols=l.match(/("([^"]|"")*"|[^,]+)/g)||[];
const clean=cols.map(c=>c.replace(/^"|"$/g,"").replace(/""/g,'"'));
return{id:clean[0]||uid(),kind:clean[1]||"expense",amount:Number(clean[2]||0),description:clean[3]||"",date:clean[4]||nowISO()}});
const list=loadEntries().concat(parsed);saveEntries(list);render();toast("Import done ‚Äî kawaii chaos merged");fileInput.value=""}
clearBtn.onclick=()=>{if(!confirm("Clear all data?"))return;localStorage.removeItem(SKEY);render();toast("all cleared ‚Äî pink reset")}
npcToggle.onchange=e=>{NPC_MODE=e.target.checked;if(NPC_MODE)toast("[NPC] Mode kawaii glitch on")}
(function boot(){document.getElementById("date").value=nowISO();if(!localStorage.getItem(SKEY)){
saveEntries([{id:uid(),kind:"income",amount:500000,description:"Seed: kawaii allowance",date:nowISO()}])}render();toast("Glitch Money Pink ready üéÄ")})();
</script>
</body>
</html>